<div class="indicatorContent">
  <div class="warning">
    <nz-alert
      *ngIf="listOfData.length === 0"
      nzType="warning"
      nzMessage="No indicators were found during the document scanning."
      nzShowIcon
      nzCloseable="true"
    >
    </nz-alert>

    <nz-alert
      *ngIf="
        this.impactCount === 0 ||
        this.outcomeCount === 0 ||
        this.outputCount === 0
      "
      nzType="info"
      nzMessage="It is recommended to have at least one indicator per level."
      nzShowIcon
      nzCloseable="true"
    >
    </nz-alert>

    <nz-alert
      *ngIf="this.impactCount > 3"
      nzType="info"
      nzMessage="It is recommended to have less than 4 indicators of the Impact level."
      nzShowIcon
      nzCloseable="true"
    >
    </nz-alert>

    <nz-alert
      *ngIf="this.outcomeCount > 5"
      nzType="info"
      nzMessage="It is recommended to have less than 6 indicators of the Outcome level."
      nzShowIcon
      nzCloseable="true"
    >
    </nz-alert>

    <nz-alert
      *ngIf="this.outputCount > 15"
      nzType="info"
      nzMessage="It is recommended to have less than 16 indicators of the Output level."
      nzShowIcon
      nzCloseable="true"
    >
    </nz-alert>

    <div style="position: relative;">
      <input
        (input)="search()"
        nzSize="large"
        style="padding-right: 30px;"
        type="text"
        nz-input
        placeholder="Search indicator"
        [(ngModel)]="searchValue"
      />
    </div>
    <div style="display: flex; flex-direction: row; margin: 10px;">
      <span
        >Total: {{ listOfData.length }} - selected: Impact {{ impactCount }},
        Outcome {{ outcomeCount }}, Output {{ outputCount }}</span
      >
    </div>
    <nz-table
      #dynamicTable
      [nzData]="displayData"
      [nzPageSize]="10"
      [nzScroll]="{ y: '300px' }"
      nzShowPagination="false"
      nzShowSizeChanger="false"
      nzSize="middle"
      nzBordered
    >
      <thead (nzSortChange)="sort($event)" nzSingleSort>
        <tr>
          <th
            nzShowCheckbox
            [(nzChecked)]="isAllDisplayDataChecked"
            [nzIndeterminate]="isIndeterminate"
            (nzCheckedChange)="checkAll($event)"
            nzWidth="50px"
          ></th>
          <th
            nzShowSort
            nzSortKey="level"
            nz-tooltip
            nzTooltipTitle="Indicator level"
            nzWidth="103px"
          >
            Level
          </th>
          <th nz-tooltip nzTooltipTitle="Indicator" style="font-weight: bold;">
            Indicator
          </th>

          <th
            nzShowSort
            nzSortKey="source"
            nzWidth="100px"
            nz-tooltip
            nzTooltipTitle="Source"
          >
            Source
          </th>
          <th
            nzShowSort
            nzSortKey="disaggregation"
            nz-tooltip
            nzTooltipTitle="Disaggregation"
            nzWidth="100px"
            style="font-size: 10px;"
          >
            Dis- aggregation
          </th>
          <th
            nzShowSort
            nzSortKey="themes"
            nzWidth="100px"
            nz-tooltip
            nzTooltipTitle="Thematic Area"
          >
            Thematic Area
          </th>
          <th
            nzShowSort
            nzSortKey="crsCode"
            nz-tooltip
            nzTooltipTitle="OECD DAC/CRS Code"
            nzWidth="100px"
          >
            OECD DAC/CRS Code
          </th>
          <th
            nzShowSort
            nzSortKey="sdgCode"
            nz-tooltip
            nzTooltipTitle="SDG Code"
            nzWidth="100px"
          >
            SDG Code
          </th>
          <th nz-tooltip nzTooltipTitle="Keyword Frequency" nzWidth="100px">
            Keyword Frequency
            <nz-slider
              (nzOnAfterChange)="onAfterChange($event)"
              [nzTooltipVisible]="'default'"
              [nzRange]='true'
              [nzMin]='sliderMinValue'
              [nzMax]='sliderMaxValue'
            ></nz-slider>
          </th>
        </tr>
      </thead>
      <tbody>
        <ng-template ngFor let-data [ngForOf]="dynamicTable.data">
          <tr
          (click)="selectindicator(data.sort_id)"
          [class.row-checked]="mapOfCheckedId[data.sort_id]"
          >
            <td
              nzShowCheckbox
              [(nzChecked)]="mapOfCheckedId[data.sort_id]"
              (nzCheckedChange)="refreshStatus()"
            ></td>
            <td>
              <nz-tag [nzColor]="data.color">{{ data.level }} </nz-tag>
            </td>
            <td>{{ data.name }}</td>
            <td>{{ data.source }}</td>
            <td style="text-align: center;">
              <div style="text-align: center;">
                <i
                  *ngIf="!data.disaggregation"
                  style="font-size: 25px; color: rgb(216, 126, 126);"
                  nz-icon
                  nzType="close"
                  nzTheme="outline"
                ></i>
                <i
                  *ngIf="data.disaggregation"
                  style="font-size: 25px; color: #a5c2ae;"
                  nz-icon
                  nzType="check"
                  nzTheme="outline"
                ></i>
              </div>
            </td>
            <td>{{ data.themes }}</td>
            <td>{{ formatCrsCode(data.crsCode) }}</td>
            <td>{{ data.sdgCode }}</td>
            <td>{{ data.numTimes }}</td>
          </tr>
        </ng-template>
      </tbody>
    </nz-table>
  </div>
</div>
